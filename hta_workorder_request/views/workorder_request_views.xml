<odoo>
  <data>
    <!-- explicit list view definition -->
    <record model="ir.ui.view" id="product_request_view">
      <field name="name">product_request_view</field>
      <field name="model">product.request</field>
      <field name="arch" type="xml">
          <form string="Product Request">
              <header>
                  <button name="button_to_approve"
                    string="Request Approval"
                    type="object"
                    class="oe_highlight"
                    states="draft"
                  />
                  <button name="button_approve"
                    string="Approve"
                    type="object"
                    class="oe_highlight"
                    states="to_approve"
                  />
                  <button name="action_confirm"
                    string="Confirm"
                    type="object"
                    class="oe_highlight"
                    states="open"
                  />
                  <button name = "set_to_draft"
                          string="remettre en brouillon"
                          type="object"
                          class="oe_highlight"
                          states="open"
                    />
                  <field name="state"
                     widget="statusbar"
                     statusbar_visible="draft,to_approve,open,done,cancel"
                     statusbar_colors='{"done":"blue"}'
                 />
              </header>
              <sheet>
                  <div class="oe_button_box" name="button_box">
                      <field name="picking_ids" invisible="1" />
                      <button
                            type="object"
                            name="action_view_picking"
                            class="oe_stat_button"
                            icon="fa-truck"
                            attrs="{'invisible': [('picking_count', '=', 0)]}"
                            groups="stock.group_stock_user"
                        >
                            <field
                                name="picking_count"
                                widget="statinfo"
                                string="Transfers"
                            />
                        </button>
                  </div>
                  <div class="oe_edit_only">
                     <label for="name" class="oe_inline" />
                  </div>
                  <h1>
                    <field name="name" class="oe_inline"/>
                  </h1>
                  
                  <group>
                  <group>
                      <field name='requested_by' options="{'no_create': True}"/>
                      <field name="analytic_account_id" options="{'no_create': True}"/>
                      <field name="picking_type_id"/>
                      <field name="location_src_id"/>
                  </group>
                  <group>
                      <field name="date" readonly='True'/>
                      <field name="project_task_id" attrs="{'readonly': [('state', 'not in', ['draft'])]}"/>
                      <field name="company_id" options="{'no_create': True}"/>
                      <field name="location_dest_id"/>
                  </group>
              </group>
              <notebook>
                  <page string='Product lines'>
                      <field name="line_ids">
                          <tree editable="bottom">
                              <field name='product_id' options="{'no_create': True}"/>
                              <field name='initial_qty' invisible='1'/>
                              <field name='product_uom_qty' attrs="{'readonly': [('request_state', 'not in', ['draft'])]}"/>
                              <field name='qty_done'/>
                              <field name='product_uom_id' string="Unit" readonly='True'/>
                              <field name='analytic_account_id' options="{'no_create': True}"/>
                              <field name="project_id" readonly='True'/>
                              <field name="task_id" readonly='True'/>
                              <field name='request_state' readonly='True'/>
                          </tree>
                      </field>
                  </page>
              </notebook>
              <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
              </div>
              </sheet>
          </form>
      </field>
    </record>
      
    <record id="view_product_request_tree" model="ir.ui.view">
            <field name="name">product.request.tree</field>
            <field name="model">product.request</field>
          <field name="arch" type="xml">
              <tree string="Product Request" decoration-warning="state=='draft'" decoration-danger="state=='cancel'">
                    <field name="date"/>
                    <field name="name" string="Product Request"/>
                    <field name="requested_by"/>
                    <field name="project_id"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                    <field name="state"/>
               </tree>
          </field>
     </record>
  </data>
</odoo>