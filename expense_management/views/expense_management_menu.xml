<odoo>
  <data>
    <record model="ir.ui.view" id="expense_request_view">
      <field name="name">expense_request_view</field>
      <field name="model">expense.request</field>
      <field name="arch" type="xml">
        <form string="Exepnse Request">
          <header>
            <button name="action_submit"
                    string="Submit"
                    type="object"
                    attrs="{'invisible': [('state', 'not in', ['draft'])]}"
            />
            <button name="button_to_approve"
                    string="To Approve"
                    type="object"
                    attrs="{'invisible': [('state', 'in', ['to_approve', 'approve'])]}"
            />
            <button name="button_approve"
                    string="Approve"
                    type="object"
                    attrs="{'invisible': [('state', 'in', ['approve'])]}"
            />
            <field name="state"
                 widget="statusbar"
                 statusbar_visible="draft,submit,to_approve,approved,post,cancel"
                 statusbar_colors='{"approved":"blue"}'
             />
          </header>
          <sheet>
              <div class="oe_edit_only">
                 <label for="name" class="oe_inline" />
              </div>
              <h1>
                    <field name="name" class="oe_inline"/>
              </h1>
               
              <group>
                  <group>
                      <field name="project_id"/>
                      <field name="analytic_account" groups="analytic.group_analytic_accounting"/>
                      <field name='journal'/>
                  </group>
                  <group>
                      <field name="date" readonly='True'/>
                      <field name="requested_by" readonly='True'/>
                  </group>
              </group>
              <notebook>
                  <page string='Expense lines'>
                      <field name="line_ids">
                          <tree>
                              <field name='name'/>
                              <field name='date'/>
                              <field name='employee_id'/>
                              <field name='amount'/>
                              <field name='payment_mode'/>
                              <field name='payed_by'/>
                              <field name='request_state'/>
                          </tree>
                      </field>
                  </page>
              </notebook>
          </sheet>
        </form>
      </field>
    </record>
    
    <record id="view_expense_request_tree" model="ir.ui.view">
            <field name="name">hr.expense.request.tree</field>
            <field name="model">expense.request</field>
          <field name="arch" type="xml">
              <tree string="Expense Request" decoration-warning="state=='draft'" decoration-danger="state=='cancel'">
                    <field name="name" string="Expense Request"/>
                    <field name="requested_by"/>
                    <field name="date"/>
                    <field name="total_amount" sum="Total Amount"/>
                    <field name="currency_id" invisible="1"/>
                    <field name="state"/>
                    <field name="company_id" groups="base.group_multi_company"/>
               </tree>
          </field>
     </record>
     
     <record id="view_expense_line_form" model="ir.ui.view">
            <field name="name">expense.line.form</field>
            <field name="model">expense.line</field>
            <field name="arch" type="xml">
                <form string="Expense Line" create="false" duplicate="false">
                    <header>
                        <field name="request_state" widget="statusbar" invisible='1'/>
                    </header>
                    <sheet>
                        <h1>
                            <field name="request_id" invisible='1'/>
                            <label for='name' class="oe_inline"/>
                            <field name='name' class="oe_inline" attrs="{'readonly': [('request_state', 'not in', ['draft', 'submit'])]}"/>
                        </h1>
                        <group>
                            <group>
                              <field name='employee_id'/>
                              <field name='amount'/>
                              <field name='payment_mode' groups='account.group_account_user'/>
                              <field name='payed_by' groups='account.group_account_user'/>
                              <field name="account_src" groups='account.group_account_user'
                                     attrs="{'readonly': [('request_state', 'not in', ['approve'])]}"
                                     />
                              <field name='request_state' invisible='1'/>
                            </group>
                            <group>
                              <field name='date'/>
                              <field name='requested_by' attrs="{'readonly': [('request_state', 'not in', ['draft', 'submit'])]}"/>
                              <field name="company_id" groups="base.group_multi_company"/>
                              <field name="account_dst" groups='account.group_account_user'
                                     attrs="{'readonly': [('request_state', 'not in', ['approve'])]}"
                                     />  
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
    
    <!-- actions opening views on models -->
    <record model="ir.actions.act_window" id="expense_management_action_window">
      <field name="name">Expense Management</field>
      <field name="res_model">expense.request</field>
      <field name="view_mode">tree,form</field>
    </record>
    
    <menuitem id="expense_management.menu_root"
        name="Expense Management"
        groups="hr.group_hr_user"
        sequence="100"
        web_icon="hr_expense,static/description/icon.png"
    />
    <menuitem name="Menu 1" id="expense_management.menu_1" parent="expense_management.menu_root"
              action="expense_management_action_window"/>
  </data>
</odoo>